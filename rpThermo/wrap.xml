<tool id="rpthermo" name="Thermodynamics" version="@TOOL_VERSION@" profile="19.09">
    <description>Calculate the formation energy of chemical species and the Gibbs free energy of their reactions and pathways in an SBML</description>
    <macros>
        <token name="@TOOL_VERSION@">5.11.1</token>
    </macros>
    <requirements>
        <requirement type="package" version="@TOOL_VERSION@">rptools</requirement>
    </requirements>
    <stdio>
        <regex match="WARNING:" level="warning" />
        <regex match="ERROR:" level="fatal" />
        <regex match="ERROR:root:ChemAxon" level="warning" />
    </stdio>
    <command detect_errors="exit_code"><![CDATA[
        python -m rptools.rpthermo
        '$input'
        '$pathway_with_thermo' 
        --ph '$adv.ph'
        --ionic_strength '$adv.ionic_strength'
        --pMg '$adv.pMg'
        --temp_k '$adv.temp_k' 
    ]]></command>
    <inputs>
        <param name="input" type="data" format="sbml" label="Pathway (rpSBML)" />
        <section name="adv" title="Advanced Options" expanded="false">
            <param name="ph" type="float" value="7.5" label="Compartment PH of the pathway" />
            <param name="ionic_strength" type="float" value="200.0" label="Compartment ionic strength of the pathway" />
            <param name="pMg" type="float" value="10.0" label="Compartment pMg of the pathway" />
            <param name="temp_k" type="float" value="298.15" label="Compartment temperature in Kelvin" />
        </section>
    </inputs>
    <outputs>
        <data name="pathway_with_thermo" format="sbml" label="${tool.name} - ${input.name}" />
    </outputs>
    <tests>
        <test>
        <!-- test 1: check if identical outputs are produced with default parameters  -->
            <param name="input" value="rp_013_0001.xml" />
            <output name="pathway_with_thermo" file="rp_013_0001_with_thermo.xml" ftype="sbml" compare="diff" sort="true" >
                <assert_contents>
                    <is_valid_xml />
                    <!--check thermo_dG0_prime value-->
                    <has_text text="-289.68604" />
                    <has_text text="-294.36576" />
                    <has_text text="-999.14922" />
                    <has_text text="-2309.75600" />
                    <!--check thermo_dGm_prime value-->
                    <has_text text="-323.91571" />
                    <has_text text="-260.13609" />
                    <has_text text="-947.80470" />
                    <has_n_lines n="483" />
                </assert_contents>
            </output>
        </test>
    </tests>
    <help><![CDATA[
Thermodynamics
===============
Calculate the formation energy of chemical species either using an internal database or estimate it by decomposing them using the `component contribution <https://gitlab.com/elad.noor/component-contribution>`_ method. Thereafter this tool predicts the Gibbs free energy of reactions and of the whole heterologous pathway by combining the formation energy of each individual compound.

.. image:: https://raw.githubusercontent.com/Galaxy-SynBioCAD/rpThermo/standalone/galaxy/img/rpThermo.png 
	:width: 80 %
	:align: center


|


Above is an illustration of the Gibbs free energy calculation using the component contribution package. The color-coded arrows from red (best) to blue (worst) show the best and worst-performing reactions.

Required:

* **input**\ : (string) Path to the input file
* **output**\ : (string) Path to the output file 

Advanced Options:

* **--ph**\ :(float) Compartment PH of the pathway
* **--ionic_strength**\ :(float) Compartment ionic strength of the pathway
* **--pMg**\ :(float) Compartment pMg of the pathway
* **--temp_k**\ :(float) Compartment temperature in Kelvin

Project Links
---------------------

* `GitHub <https://github.com/brsynth/rptools/tree/master/rptools/rpthermo>`_

Version
----------

v5.11.1

Authors
-------

* **Melchior du Lac** 

Acknowledgments
---------------

* Thomas Duigou
* Joan HÃ©risson

    ]]></help>
    <citations>
        <citation type="doi">10.1371/journal.pcbi.1003098 </citation>
    </citations>
</tool>